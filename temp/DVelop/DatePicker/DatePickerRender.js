function WWP_DatePicker_UC(){this.show=function(){defaultWWPDateRangeSettings.minYear=this.MinYear;defaultWWPDateRangeSettings.maxYear=this.MaxYear;defaultWWPDateRangeSettings.style=this.Style;defaultWWPDateRangeSettings.optsLoaded=!0}}function WWPDateTimePicker_updateOption(n,t,i,r){var u=!1;i!=null?(n[t]=r?moment(i):i,n.settingsBeforeMerge!=null&&(n.settingsBeforeMerge[t]=n[t]),n.flatDisplay&&(n.minDate&&n.startDate.isBefore(n.minDate)||n.maxDate&&n.endDate.isAfter(n.maxDate))&&n.clickCancel(),u=!0):n.formattedDays!=null&&t=="formattedDays"&&(n.formattedDays=null,u=!0);u&&(n.flatDisplay||n.isShowing)&&(t=="formattedDays"?n.updateCalendars():n.updateView())}window.Calendar||(Calendar={});Calendar.setup=function(n){var t="#"+n.inputField,f=n.showsTime,a=n.weekNumbers,v=n.mondayFirst,i=n.ifFormat,r=n.button,e=r==null?n.flat:null,y=r!=null||n.onSelect!=null?n.onSelect:n.flatCallback,g=n.align,p=n.singleClick,w=n.displayRight,o=mapGXDateFormatToDatePickerFormat(i,f),d,u,c,l;defaultWWPDateRangeSettings.dateFormat||n.inputField!="vPICKERDUMMYVARIABLE_MPAGE"||(defaultWWPDateRangeSettings.dateFormat=o,defaultWWPDateRangeSettings.mondayFirst=v);var b={DatePicker:{Show:!f||i.indexOf("/")>=0,ShowDropdowns:!0,ShowWeekNumbers:a,SingleDatePicker:!0},TimePicker:{Show:f,Hour24:i.indexOf("%p")<0,ShowSeconds:i.indexOf("%S")>0,Increment:1},Locale:{Format:o},Advanced:{AutoApply:p,OpenLocation:w?"right":null},parentEl:e!=null?$(t).parent():null,flatDisplay:e!=null},s=$(t).val(),k=new gx.date.gxdate(s),h=gx.date.isNullDate(k);if(h&&$(t).val(""),d=new WWP_DateRangePicker(t,b,WWP_DatePicker_UC_on_Changed.closure({field:$(t),vStruct:gx.O.getValidStructFld(n.inputField),onSelect:y})),h&&$(t).val(s),u=function(n){var u=$(t).val(),r=new gx.date.gxdate(u),i=$(t).data("daterangepicker");!r||gx.date.isNullDate(r)?($(n.attachedCtrl).val(""),i.setStartDate(new Date),i.setEndDate(new Date),i.isNullVal=!0):(i.isNullVal=!1,i.setStartDate(r.Value),i.setEndDate(r.Value))},r!=null)$("#"+r).on("click",function(){u(this);var n=$(t);gx.O.getValidStructFld($(t).attr("id"))==null&&n.focus().blur();gx.csv.setFocusOnload&&($(t).data("daterangepicker").forceOpenCalendar=!0);n.trigger("click")});else e!=null&&(c=$(t).data("daterangepicker"),c.flatDisplay=!0,$(t).trigger("click"),MutationObserver=window.MutationObserver||window.WebKitMutationObserver,l=new MutationObserver(function(){var n=$(t);if(n.length==1){var o=n.val(),f=new gx.date.gxdate(o),i=n.data("daterangepicker"),e=gx.date.isNullDate(f),r=!1;e!=i.isNullVal?r=!0:e||(r=moment(f.Value)+""!=i.startDate+"");r&&(u(n[0]),i.updateView())}}),l.observe($(t)[0],{attributeFilter:["data-gxoldvalue"]}));$(t).on("focusin",function(){u(this)})};var WWP_DatePicker_UC_on_Changed=function(n){var u,f;this.startDate=n;var t=$(this.field),i=this.vStruct,e=t[0],r=this.onSelect;r&&r(null,n||gx.date.nullDate(),e,i,gx.O);u=t.data("daterangepicker");this.startDate?u.updateElement(!0):i?(f=gx.date.nulldate_toc(i.len,i.dec),t.val(f)):(t.val(""),console.log("WWP_DatePicker_UC: Ctrl on screen not found:"+this.field))};$(window).one('load',function(){WWP_VV([['WWP.DatePicker','15.4.0']]);});